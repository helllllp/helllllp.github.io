<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />

    

    
    <title>代理服务之squid+sarg | helllllp!</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="linux,proxy" />
    
    <meta name="description" content="代理服务器软件最近有个需求要用到代理服务器，搜索了一番，用得比较多的是windows平台上的ccproxy，不过反应软件不太靠谱，软件经常会崩溃，比较靠谱的是linux平台下的squid。其实还有比较优秀的代理软件如轻量级的tinyproxy，privoxy，还有重量级的vanish和nginx。轻量级的软件不支持缓存，故选择squid。 Varnish与Nginx缓存服务器 1、高性能缓存服务">
<meta property="og:type" content="article">
<meta property="og:title" content="代理服务之squid+sarg">
<meta property="og:url" content="https://blog.hellshan.top/archives/c624573e/index.html">
<meta property="og:site_name" content="helllllp!">
<meta property="og:description" content="代理服务器软件最近有个需求要用到代理服务器，搜索了一番，用得比较多的是windows平台上的ccproxy，不过反应软件不太靠谱，软件经常会崩溃，比较靠谱的是linux平台下的squid。其实还有比较优秀的代理软件如轻量级的tinyproxy，privoxy，还有重量级的vanish和nginx。轻量级的软件不支持缓存，故选择squid。 Varnish与Nginx缓存服务器 1、高性能缓存服务">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.hellshan.top/archives/c624573e/1.jpg">
<meta property="article:published_time" content="2021-03-05T06:52:05.000Z">
<meta property="article:modified_time" content="2023-10-20T06:28:06.205Z">
<meta property="article:author" content="HellShan">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="proxy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.hellshan.top/archives/c624573e/1.jpg">
    

    

    
        <link rel="icon" href="/css/images/favicon.png" />
    

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/libs/titillium-web/styles.css">

    
<link rel="stylesheet" href="/libs/source-code-pro/styles.css">


    
<link rel="stylesheet" href="/css/style.css">


    
<script src="/libs/jquery/3.5.0/jquery.min.js"></script>

    
    
        
<link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">

    
    
        
<link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">

    
    
    
    



<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="helllllp!" type="application/atom+xml">
</head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">主页</a>
                                </li>
                            
                                        <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/">学而时习之</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/%E5%AE%9E%E8%B7%B5%E9%AA%8C%E8%AF%81%E7%9C%9F%E7%90%86/">实践验证真理</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/%E6%8B%BF%E6%9D%A5%E4%B8%BB%E4%B9%89/">拿来主义</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/%E6%B8%A9%E6%95%85%E8%80%8C%E7%9F%A5%E6%96%B0/">温故而知新</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E6%96%87%E6%91%98/">文摘</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E6%96%87%E6%91%98/%E4%BA%BA%E7%89%A9/">人物</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E6%96%87%E6%91%98/%E5%8E%86%E5%8F%B2/">历史</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E6%96%87%E6%91%98/%E5%9C%B0%E7%90%86/">地理</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E6%96%87%E6%91%98/%E6%94%BF%E6%B2%BB/">政治</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E6%96%87%E6%91%98/%E7%BB%8F%E6%B5%8E/">经济</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E6%9D%82%E5%BF%97/">杂志</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E6%9D%82%E5%BF%97/%E8%88%AA%E6%8B%8D%E4%B8%AD%E5%9B%BD/">航拍中国</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E7%83%AD%E7%82%B9/">热点</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/%E7%83%AD%E7%82%B9/%E5%B9%B3%E5%8F%B0/">平台</a></li></ul></li></ul>
                                    
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/dashboard/index.html">仪表板</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/about/index.html">关于</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><input type="hidden" name="sitesearch" value="https://blog.hellshan.top"></form>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/">学而时习之</a><i class="icon fa fa-angle-right"></i><a class="page-title-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/%E5%AE%9E%E8%B7%B5%E9%AA%8C%E8%AF%81%E7%9C%9F%E7%90%86/">实践验证真理</a>
    </h1>
</div>

                        <div class="main-body-content">
                            <article id="post-代理服务之squid+sarg" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        代理服务之squid+sarg
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
      <i class="fa fa-calendar"></i>
      <a href="/archives/c624573e/" class="article-date">
         <time datetime="2021-03-05T06:52:05.000Z" itemprop="datePublished">2021-03-05</time>
      </a>
    </div>


                

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link-link" href="/tags/linux/" rel="tag">linux</a>, <a class="tag-link-link" href="/tags/proxy/" rel="tag">proxy</a>
    </div>

                
   <span id="/archives/c624573e/" class="leancloud-visitors" data-flag-title="代理服务之squid+sarg">
   <i class="fa fa-eye"></i>
   <span class="post-meta-item-text">阅读次数: </span>
   <i class="leancloud-visitors-count">1000000</i>
   </span>


                

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            

            

            

            <p><img src="/archives/c624573e/1.jpg" alt=" "></p>
<h2 id="代理服务器软件"><a href="#代理服务器软件" class="headerlink" title="代理服务器软件"></a>代理服务器软件</h2><p>最近有个需求要用到代理服务器，搜索了一番，用得比较多的是windows平台上的ccproxy，不过反应软件不太靠谱，软件经常会崩溃，比较靠谱的是linux平台下的squid。其实还有比较优秀的代理软件如轻量级的tinyproxy，privoxy，还有重量级的vanish和nginx。轻量级的软件不支持缓存，故选择squid。</p>
<p>Varnish与Nginx缓存服务器</p>
<p>1、高性能缓存服务器Varnish<br>Varnish是一款高性能的、开源的方向代理服务器和缓存器。挪威最大的在线报纸Verdens Gang使用了3台Varnish代替了原来的12台Squid，性能更好！</p>
<p>Varnish与Squid的对比如下：</p>
<p>（1）优点</p>
<p>Varnish具有更好的稳定性、更快的访问速度、更多的并发连接支持数，可以通过管理端口来管理缓存。</p>
<p>（2）缺点</p>
<p>1)在高并发状态下，Varnish消耗更多的CPU、I/O和内存资源。</p>
<p>2)Varnish进程一旦挂起、崩溃或者重启，缓存的数据会从内存中释放，此时所有的请求都会转发到后端服务器，给后端服务器造成很大压力。</p>
<p>2、轻量级缓存服务器Nginx</p>
<p>Nginx支持类似Squid的缓存功能，把URL以及相关信息当成key，用MD5编码Hash后把数据文件保存在硬盘上。</p>
<p>Nginx只能为只当的URL或者状态码设置过期时间，并不支持类似Squid的purge命令来手动清除指定的缓存页面。可以通过第三方的ngx_cache_purge来清除指定的URL缓存。</p>
<p>Nginx的缓存加速功能是由proxy_cache和fastcgi_cache两个功能模块完成的。</p>
<p>Nginx缓存加速的特点如下：<br>1)缓存功能十分稳点，运行速度不逊于Squid。<br>2)对多核CPU的利用率比其他的开源软件要好。<br>3)支持高并发请求数，能同时承受更多的访问请求。</p>
<h2 id="代理基本类型"><a href="#代理基本类型" class="headerlink" title="代理基本类型"></a>代理基本类型</h2><p>根据实现的方式不同，squid代理服务可分为传统代理和透明代理两个常见的代理服务。</p>
<p>1)传统代理<br>也就是普通的代理服务，首先必须在客户机的浏览器、QQ聊天工具、下载软件等程序中手动设置代理服务器的地址和端口，然后才能使用代理服务来访问网络。对于网页浏览器，访问网站时的域名解析请求也会发送给指定的代理服务器。</p>
<p>2)透明代理<br>提供与传统代理相同的功能和服务，其区别在于客户机不需要指定代理服务器的地址和端口，而是通过默认路由、防火墙策略将Web访问重定向，实际上仍然交给代理服务器来处理。重定向的过程对客户机来说时是“透明”的，用户甚至并不知道自己在使用代理服务，所以称为“透明代理”。使用透明代理时，网页浏览器访问网站时的域名解析请求将优先发给DNS服务器。</p>
<p>在实际应用中，传统代理多见于Internet环境，如为QQ程序使用代理可以隐藏本机真实IP地址，为下载工具使用多个代理可以规避服务器的并发连接限制。而透明带多见于局域网环境，如在Linux网关中启用透明代理后，局域网主机无需进行额外的设置就可以享受更好的上网速度。</p>
<h2 id="搭建Squid传统代理服务器"><a href="#搭建Squid传统代理服务器" class="headerlink" title="搭建Squid传统代理服务器"></a>搭建Squid传统代理服务器</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>到官网下载最新的squid源码包<br>解压：<br><code>tar zxf squid-5.0.5.tar.gz</code></p>
<p>安装编译环境：<br><code>yum install gcc gcc-c++ make perl-devel -y</code></p>
<p>编译：<br><code>cd squid-5.0.5</code></p>
<p><code>./configure \</code></p>
<p># 把软件安装到指定位置<br><code>--prefix=/app/squid-5.0.5 \</code>  </p>
<p># 可以在规则中设置为直接通过客户端MAC进行管理，防止客户端使用IP欺骗<br><code>--enable-arp-acl \</code></p>
<p># 使用内核过滤<br><code>--enable-linux-netfilter \</code> </p>
<p># 支持透明模式<br><code>--enable-linux-tproxy \</code></p>
<p># 异步I/O，提升存储性能<br><code>--enable-async-io=100 \</code></p>
<p># 错误信息的显示语言<br><code>--enable-err-language=&quot;Simplify_Chinese&quot; \</code>  </p>
<p># 允许URL中有下划线<br><code>--enable-underscore \</code> </p>
<p># 使用poll()模式，提升性能<br><code>--enable-poll \</code>      </p>
<p># 使用GNU正则表达式<br><code>--enable-gnuregex</code>   </p>
<p>安装:<br><code>make &amp;&amp; make install</code></p>
<p>创建squid用户:<br><code>useradd -M -s /sbin/nologin squid</code></p>
<p>修改属主和属组:<br><code>chwon -R squid:squid /app/squid-5.0.5</code></p>
<p>创建软连接:<br><code>cd /app</code></p>
<p><code>ln -s squid-5.0.5 squid</code></p>
<h3 id="更改配置文件"><a href="#更改配置文件" class="headerlink" title="更改配置文件"></a>更改配置文件</h3><p><code>vim /app/squid/etc/squid.conf</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">http_access allow all</span><br><span class="line">http_port 3128</span><br><span class="line">visible_hostname 192.168.1.200 # 指定可见主机名</span><br><span class="line">cache_mem 64 MB</span><br><span class="line">cache_swap_low 80</span><br><span class="line">cache_swap_high 97</span><br><span class="line">cache_dir ufs &#x2F;app&#x2F;squid&#x2F;var&#x2F;cache&#x2F;squid 512 16 256 # 配置硬盘缓存，打开缓存目录512M，其中一级目录16个，二级256个</span><br><span class="line">cache_effective_user squid</span><br><span class="line">cache_effective_group squid</span><br></pre></td></tr></table></figure>
<p>检查配置文件:<br><code>squid -k parse</code></p>
<p>重新加载配置文件:<br><code>squid -k rec</code></p>
<p>初始化缓存目录:<br><code>squid -zX</code></p>
<h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><p>添加squid.service:<br><code>vim /usr/lib/systemd/system/squid.service</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description&#x3D;squid</span><br><span class="line">Wants&#x3D;network-online.target</span><br><span class="line">After&#x3D;network-online.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type&#x3D;forking</span><br><span class="line">PIDFile&#x3D;&#x2F;app&#x2F;squid&#x2F;var&#x2F;run&#x2F;squid.pid</span><br><span class="line">ExecStart&#x3D;&#x2F;app&#x2F;squid&#x2F;sbin&#x2F;squid</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy&#x3D;multi-user.target</span><br></pre></td></tr></table></figure>
<p>重载systemctl:<br><code>systemctl daemon-reload</code></p>
<p>开启squid:<br><code>systemctl start squid</code></p>
<p>查看监听端口：<br><code>ss -tunlp | grep squid</code></p>
<h2 id="服务器多端口设置"><a href="#服务器多端口设置" class="headerlink" title="服务器多端口设置"></a>服务器多端口设置</h2><h3 id="使用docker实现多端口"><a href="#使用docker实现多端口" class="headerlink" title="使用docker实现多端口"></a>使用docker实现多端口</h3><p>从官方网站或者第三方docker镜像启动后获取默认squid配置，存放到/software目录下：<br><code>docker cp xxxx:/etc/squid/squid.conf /software</code></p>
<p>xxx为容器ID</p>
<p>导出排除注释的配置：<br><code>egrep -v &quot;^#|^$&quot; squid.conf &gt; squid.conf.1</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">acl localnet src 10.0.0.0&#x2F;8	# RFC1918 possible internal network</span><br><span class="line">acl localnet src 172.16.0.0&#x2F;12	# RFC1918 possible internal network</span><br><span class="line">acl localnet src 192.168.0.0&#x2F;16	# RFC1918 possible internal network</span><br><span class="line">acl localnet src fc00::&#x2F;7       # RFC 4193 local private network range</span><br><span class="line">acl localnet src fe80::&#x2F;10      # RFC 4291 link-local (directly plugged) machines</span><br><span class="line">acl SSL_ports port 443</span><br><span class="line">acl Safe_ports port 80		# http</span><br><span class="line">acl Safe_ports port 21		# ftp</span><br><span class="line">acl Safe_ports port 443		# https</span><br><span class="line">acl Safe_ports port 70		# gopher</span><br><span class="line">acl Safe_ports port 210		# wais</span><br><span class="line">acl Safe_ports port 1025-65535	# unregistered ports</span><br><span class="line">acl Safe_ports port 280		# http-mgmt</span><br><span class="line">acl Safe_ports port 488		# gss-http</span><br><span class="line">acl Safe_ports port 591		# filemaker</span><br><span class="line">acl Safe_ports port 777		# multiling http</span><br><span class="line">acl CONNECT method CONNECT</span><br><span class="line">#http_access deny !Safe_ports</span><br><span class="line">#http_access deny CONNECT !SSL_ports</span><br><span class="line">http_access allow localhost manager</span><br><span class="line">http_access deny manager</span><br><span class="line">http_access deny to_localhost</span><br><span class="line">http_access allow localnet</span><br><span class="line">http_access allow localhost</span><br><span class="line">http_access allow all</span><br><span class="line">http_port 3128</span><br><span class="line">cache_dir ufs &#x2F;var&#x2F;spool&#x2F;squid 100 16 256</span><br><span class="line">coredump_dir &#x2F;var&#x2F;spool&#x2F;squid</span><br><span class="line">refresh_pattern ^ftp:		1440	20%	10080</span><br><span class="line">refresh_pattern ^gopher:	1440	0%	1440</span><br><span class="line">refresh_pattern -i (&#x2F;cgi-bin&#x2F;|\?) 0	0%	0</span><br><span class="line">refresh_pattern (Release|Packages(.gz)*)$      0       20%     2880</span><br><span class="line">refresh_pattern .		0	20%	4320</span><br></pre></td></tr></table></figure>
<p>注释掉http_access deny !Safe_ports和http_access deny CONNECT !SSL_ports，http_access allow all这样就相当于无限制访问</p>
<p>建立文件夹以存放docker的日志和缓存:<br><code>mkdir -p /app/docker-squid/&#123;logs,data,etc&#125;</code></p>
<p>把配置文件拷贝到etc目录下:<br><code>cp /software/squid.conf.1 /app/docker-squid/etc/squid.conf</code></p>
<p>新建docker-compose.yml:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;2&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">squid-all:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">squid-all</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">datadog/squid</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">       <span class="bullet">-</span> <span class="number">3128</span><span class="string">:3128</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/app/docker-squid/logs:/var/log/squid</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/app/docker-squid/data:/var/spool/squid</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/app/docker-squid/etc/squid.conf:/etc/squid/squid.conf</span></span><br></pre></td></tr></table></figure>
<p>使用的是hub.docker.com上的第三方镜像</p>
<p>使用docker创建容器：<br><code>docker-compose -f docker-compose.yml -d up</code></p>
<p>测试OK</p>
<h3 id="使用dstdomain设置访问网页白名单"><a href="#使用dstdomain设置访问网页白名单" class="headerlink" title="使用dstdomain设置访问网页白名单"></a>使用dstdomain设置访问网页白名单</h3><p>配置如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">acl localnet src 10.0.0.0&#x2F;8	# RFC1918 possible internal network</span><br><span class="line">acl localnet src 172.16.0.0&#x2F;12	# RFC1918 possible internal network</span><br><span class="line">acl localnet src 192.168.0.0&#x2F;16	# RFC1918 possible internal network</span><br><span class="line">acl localnet src fc00::&#x2F;7       # RFC 4193 local private network range</span><br><span class="line">acl localnet src fe80::&#x2F;10      # RFC 4291 link-local (directly plugged) machines</span><br><span class="line">acl SSL_ports port 443</span><br><span class="line">acl Safe_ports port 80		# http</span><br><span class="line">acl Safe_ports port 21		# ftp</span><br><span class="line">acl Safe_ports port 443		# https</span><br><span class="line">acl Safe_ports port 70		# gopher</span><br><span class="line">acl Safe_ports port 210		# wais</span><br><span class="line">acl Safe_ports port 1025-65535	# unregistered ports</span><br><span class="line">acl Safe_ports port 280		# http-mgmt</span><br><span class="line">acl Safe_ports port 488		# gss-http</span><br><span class="line">acl Safe_ports port 591		# filemaker</span><br><span class="line">acl Safe_ports port 777		# multiling http</span><br><span class="line">acl Safe_ports port 8080        # qyweixin client login</span><br><span class="line">acl CONNECT method CONNECT</span><br><span class="line">acl whitelist dstdomain &quot;&#x2F;app&#x2F;squid&#x2F;etc&#x2F;whitelist&quot;</span><br><span class="line">http_access deny !whitelist</span><br><span class="line">#http_access deny !Safe_ports</span><br><span class="line">#http_access deny CONNECT !SSL_ports</span><br><span class="line">http_access allow localhost manager</span><br><span class="line">http_access deny manager</span><br><span class="line">http_access deny to_localhost</span><br><span class="line">http_access allow localnet</span><br><span class="line">http_access allow localhost</span><br><span class="line">http_access deny all</span><br><span class="line">http_port 3129</span><br><span class="line">cache_mem 64 MB</span><br><span class="line">cache_swap_low 80</span><br><span class="line">cache_swap_high 97</span><br><span class="line">cache_dir ufs &#x2F;app&#x2F;squid&#x2F;var&#x2F;cache&#x2F;squid 512 16 256</span><br><span class="line">cache_effective_user squid</span><br><span class="line">cache_effective_group squid</span><br><span class="line">refresh_pattern ^ftp:		1440	20%	10080</span><br><span class="line">refresh_pattern ^gopher:	1440	0%	1440</span><br><span class="line">refresh_pattern -i (&#x2F;cgi-bin&#x2F;|\?) 0	0%	0</span><br><span class="line">refresh_pattern (Release|Packages(.gz)*)$      0       20%     2880</span><br><span class="line">refresh_pattern .		0	20%	4320</span><br></pre></td></tr></table></figure><br>增加了：<br><code>acl whitelist dstdomain &quot;/app/squid/etc/whitelist&quot;
http_access deny !whitelist</code></p>
<p>通过whitelist文件设置白名单，禁止白名单外的地址访问<br>whitelist设置的白名单地址可以是全域名地址，也可以是通配：<br>.qq.com<br>.jiandaoyun.com<br>.tbk.cn<br>.jdycdn.com<br>.qpic.cn<br>.qlogo.cn<br>.就是代表通配</p>
<h2 id="squid日志分析"><a href="#squid日志分析" class="headerlink" title="squid日志分析"></a>squid日志分析</h2><h3 id="安装apache"><a href="#安装apache" class="headerlink" title="安装apache"></a>安装apache</h3><p><code>yum install -y httpd</code></p>
<p><code>systemctl enable httpd</code></p>
<p><code>systemctl start httpd</code></p>
<p>检查端口:<br><code>ss -tunlp | grep httpd</code></p>
<p>测试：<br>浏览器访问<a target="_blank" rel="noopener" href="http://192.168.1.200">http://192.168.1.200</a>（服务器地址）</p>
<h3 id="安装sarg"><a href="#安装sarg" class="headerlink" title="安装sarg"></a>安装sarg</h3><p><code>tar zxf sarg-2.4.0.tar.gz</code></p>
<p><code>cd sarg-2.4.0</code></p>
<p><code>./configure \</code></p>
<p><code>--prefix=/app/sarg-2.4.0</code></p>
<p><code>enable-extraprotection</code></p>
<p>编译安装:<br><code>make &amp;&amp; make install</code></p>
<p>创建软连接<br><code>cd /app</code></p>
<p><code>ln -s sarg-2.4.0 sarg</code></p>
<h3 id="修改配置"><a href="#修改配置" class="headerlink" title="修改配置"></a>修改配置</h3><p><code>vi /app/sarg/etc/sarg/sarg.conf</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">access_log &#x2F;app&#x2F;squid&#x2F;var&#x2F;logs&#x2F;access.log  # squid的访问日志位置</span><br><span class="line">title &quot;Squid User Access Reports&quot;  # 网页标题</span><br><span class="line">output_dir &#x2F;var&#x2F;www&#x2F;html&#x2F;squid  # 分析报告的存放位置</span><br><span class="line">user_ip no # 不使用IP代替用户ID</span><br><span class="line">topuser_sort_field BYTES reverse # 升序排列</span><br><span class="line">user_sort_field BYTES reverse</span><br><span class="line">exclude_hosts &#x2F;app&#x2F;sarg&#x2F;noreport  # 设置不生成报告的主机</span><br><span class="line">overwrite_report no</span><br><span class="line">mail_utility mailx # 指定发邮件命令</span><br><span class="line">charset UTF-8</span><br><span class="line">weekdays 0-6 # 指定top排序星期周期</span><br><span class="line">hours 7-12,14,16,18-20  # 指定top排序时间周期</span><br><span class="line">www_document_root &#x2F;var&#x2F;www&#x2F;html # 网页根目录</span><br></pre></td></tr></table></figure>
<p>建立不生成报告的主机列表文件<br><code>touch /app/sarg/noreport</code></p>
<p>按小时生成squid流量报表</p>
<p>新建一个sh文件:<br><code>vim /root/squid-hours.sh</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">Date=$(date -d <span class="string">&quot;1 hours ago&quot;</span> +<span class="string">&quot;%y%m%d%H&quot;</span>)</span><br><span class="line">/app/squid/sbin/squid -k rotate</span><br><span class="line">sleep 10</span><br><span class="line">Squiddir=<span class="string">&#x27;/app/squid/var/logs&#x27;</span></span><br><span class="line">Access=<span class="string">&#x27;access.log.*&#x27;</span></span><br><span class="line">/bin/mv <span class="variable">$&#123;Squiddir&#125;</span>/<span class="variable">$&#123;Access&#125;</span> <span class="variable">$&#123;Squiddir&#125;</span>/access<span class="variable">$&#123;Date&#125;</span>.<span class="built_in">log</span></span><br><span class="line">/app/sarg/bin/sarg -o /var/www/html/hours  -l  <span class="variable">$&#123;Squiddir&#125;</span>/access<span class="variable">$&#123;Date&#125;</span>.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>
<p>创建计划任务执行sarg记录，只在上班时间执行。<br><code>crontab -e</code></p>
<p><code>0 9,10,11,12,13,14,15,16,17,18,19 * * * /root/sarg-hour.sh</code></p>
<h3 id="验证访问"><a href="#验证访问" class="headerlink" title="验证访问"></a>验证访问</h3><p><a target="_blank" rel="noopener" href="http://192.168.1.200/squid-reports/">http://192.168.1.200/squid-reports/</a></p>
<h2 id="ss5配置"><a href="#ss5配置" class="headerlink" title="ss5配置"></a>ss5配置</h2><p>squid只支持http和https类型的代理，某些应用需要用到socks5代理，这时需要配置上ss5</p>
<p>安装环境：<br><code>yum install pam-devel openldap-devel openssl-devel</code></p>
<p><code>yum -y install gcc automake make pam-devel openldap-devel cyrus-sasl-devel</code></p>
<p>下载ss5：<br><code>wget http://downloads.sourceforge.net/project/ss5/ss5/3.8.9-8/ss5-3.8.9-8.tar.gz</code></p>
<p>安装：<br><code>tar -xzvf ss5-3.8.9-8.tar.gz</code></p>
<p><code>cd ss5-3.8.9</code></p>
<p><code>./configure</code></p>
<p><code>make</code></p>
<p><code>make install</code></p>
<p>配置无用户认证方式<br><code>vim /etc/opt/ss5/ss5.conf</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">auth    0.0.0.0&#x2F;0               -               -</span><br><span class="line">permit -    0.0.0.0&#x2F;0    -    0.0.0.0&#x2F;0    -    -    -    -    -   </span><br></pre></td></tr></table></figure>
<p>配置用户认证方式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">auth    0.0.0.0&#x2F;0               -               u</span><br><span class="line">permit -    0.0.0.0&#x2F;0    -    0.0.0.0&#x2F;0    -    -    -    -    -</span><br><span class="line"></span><br><span class="line">cat &#x2F;etc&#x2F;opt&#x2F;ss5&#x2F;ss5.passwd</span><br><span class="line">test test</span><br></pre></td></tr></table></figure>
<p>启动服务：<br><code>chmod a+x /etc/init.d/ss5</code></p>
<p><code>systemctl start ss5</code></p>
<p>查看端口:<br><code>ss -tunlp | grep ss5</code></p>

        </div>
        <footer class="article-footer">
            



    <a data-url="https://blog.hellshan.top/archives/c624573e/" data-id="clvey90ly001ok2o92ldxelt2" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "author": {
            "@type": "Person",
            "name": "HellShan"
        },
        "headline": "代理服务之squid+sarg",
        "image": "https://blog.hellshan.top/archives/c624573e/1.jpg",
        "keywords": "linux proxy",
        "genre": "学而时习之 实践验证真理",
        "datePublished": "2021-03-05",
        "dateCreated": "2021-03-05",
        "dateModified": "2023-10-20",
        "url": "https://blog.hellshan.top/archives/c624573e/",
        "description": "
代理服务器软件最近有个需求要用到代理服务器，搜索了一番，用得比较多的是windows平台上的ccproxy，不过反应软件不太靠谱，软件经常会崩溃，比较靠谱的是linux平台下的squid。其实还有比较优秀的代理软件如轻量级的tinyproxy，privoxy，还有重量级的vanish和nginx。轻量级的软件不支持缓存，故选择squid。
Varnish与Nginx缓存服务器
1、高性能缓存服务",
        "wordCount": 1156
    }
</script>

</article>

    <section id="comments">
    
        
    <!-- Valine -->
    <div class="vcomments"></div>


    
    </section>



                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>关注我 :</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/helllllp" target="_blank" rel="noopener">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="weibo" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-weibo"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="qq" href="/524311610" target="_blank" rel="noopener">
                        <i class="icon fa fa-qq"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="weixin" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-weixin"></i>
                    </a>
                </li>
                
            
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/archives/c7f897e8/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption">下一篇</strong>
        <p class="article-nav-title">
        
            一篇文章搞懂无线林林总总
        
        </p>
        <i class="icon fa fa-chevron-right" id="icon-chevron-right"></i>
    </a>
    
    
        <a href="/archives/588cdfd2/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">上一篇</strong>
        <p class="article-nav-title">叙利亚，现实版的旧中国</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                

            
                
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/archives/dc365dfe/" class="thumbnail">
    
    
        <span style="background-image:url(/archives/dc365dfe/1.png)" alt="华为AC6605开启Portal认证" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/">学而时习之</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/%E5%AE%9E%E8%B7%B5%E9%AA%8C%E8%AF%81%E7%9C%9F%E7%90%86/">实践验证真理</a></p>
                            <p class="item-title"><a href="/archives/dc365dfe/" class="title">华为AC6605开启Portal认证</a></p>
                            <p class="item-date"><time datetime="2024-02-17T09:06:22.000Z" itemprop="datePublished">2024-02-17</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/archives/fd81114f/" class="thumbnail">
    
    
        <span style="background-image:url(/archives/fd81114f/1.png)" alt="人工智能，机器学习" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/">学而时习之</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/%E6%8B%BF%E6%9D%A5%E4%B8%BB%E4%B9%89/">拿来主义</a></p>
                            <p class="item-title"><a href="/archives/fd81114f/" class="title">人工智能，机器学习</a></p>
                            <p class="item-date"><time datetime="2023-10-11T03:57:05.000Z" itemprop="datePublished">2023-10-11</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/archives/ca9e08db/" class="thumbnail">
    
    
        <span style="background-image:url(/archives/ca9e08db/1.png)" alt="系统运维之日志管理审计" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/">学而时习之</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/%E5%AE%9E%E8%B7%B5%E9%AA%8C%E8%AF%81%E7%9C%9F%E7%90%86/">实践验证真理</a></p>
                            <p class="item-title"><a href="/archives/ca9e08db/" class="title">系统运维之日志管理审计</a></p>
                            <p class="item-date"><time datetime="2023-09-22T07:05:05.000Z" itemprop="datePublished">2023-09-22</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/archives/2c7c4db8/" class="thumbnail">
    
    
        <span style="background-image:url(/archives/2c7c4db8/1.png)" alt="大模型部署" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/">学而时习之</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/%E5%AE%9E%E8%B7%B5%E9%AA%8C%E8%AF%81%E7%9C%9F%E7%90%86/">实践验证真理</a></p>
                            <p class="item-title"><a href="/archives/2c7c4db8/" class="title">大模型部署</a></p>
                            <p class="item-date"><time datetime="2023-09-06T02:32:05.000Z" itemprop="datePublished">2023-09-06</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/archives/54422da7/" class="thumbnail">
    
    
        <span style="background-image:url(/archives/54422da7/1.png)" alt="CentOS实体机救援和虚拟化" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/">学而时习之</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/%E5%AE%9E%E8%B7%B5%E9%AA%8C%E8%AF%81%E7%9C%9F%E7%90%86/">实践验证真理</a></p>
                            <p class="item-title"><a href="/archives/54422da7/" class="title">CentOS实体机救援和虚拟化</a></p>
                            <p class="item-date"><time datetime="2023-08-05T09:57:05.000Z" itemprop="datePublished">2023-08-05</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/">学而时习之</a><span class="category-list-count">31</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/%E5%AE%9E%E8%B7%B5%E9%AA%8C%E8%AF%81%E7%9C%9F%E7%90%86/">实践验证真理</a><span class="category-list-count">20</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/%E6%8B%BF%E6%9D%A5%E4%B8%BB%E4%B9%89/">拿来主义</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E8%80%8C%E6%97%B6%E4%B9%A0%E4%B9%8B/%E6%B8%A9%E6%95%85%E8%80%8C%E7%9F%A5%E6%96%B0/">温故而知新</a><span class="category-list-count">5</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%96%87%E6%91%98/">文摘</a><span class="category-list-count">19</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%96%87%E6%91%98/%E4%BA%BA%E7%89%A9/">人物</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%96%87%E6%91%98/%E5%8E%86%E5%8F%B2/">历史</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%96%87%E6%91%98/%E5%9C%B0%E7%90%86/">地理</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%96%87%E6%91%98/%E6%94%BF%E6%B2%BB/">政治</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%96%87%E6%91%98/%E7%BB%8F%E6%B5%8E/">经济</a><span class="category-list-count">6</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E5%BF%97/">杂志</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E5%BF%97/%E8%88%AA%E6%8B%8D%E4%B8%AD%E5%9B%BD/">航拍中国</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%83%AD%E7%82%B9/">热点</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%83%AD%E7%82%B9/%E5%B9%B3%E5%8F%B0/">平台</a><span class="category-list-count">2</span></li></ul></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">二月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">十月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">八月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">七月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">八月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">四月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">七月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">3</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">标签</h3>
        <div class="widget">
            <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AD/" rel="tag">AD</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ELK/" rel="tag">ELK</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LLM/" rel="tag">LLM</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WLAN/" rel="tag">WLAN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/article/" rel="tag">article</a><span class="tag-list-count">19</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cluster/" rel="tag">cluster</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/database/" rel="tag">database</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag">k8s</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kvm/" rel="tag">kvm</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/monitor/" rel="tag">monitor</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/" rel="tag">nginx</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/proxy/" rel="tag">proxy</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/seo/" rel="tag">seo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%85%E6%B8%B8/" rel="tag">旅游</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag">网络</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%88%AA%E6%8B%8D/" rel="tag">航拍</a><span class="tag-list-count">1</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-float">
        <h3 class="widget-title">标签云</h3>
        <div class="widget tagcloud">
            <a href="/tags/AD/" style="font-size: 13.33px;">AD</a> <a href="/tags/ELK/" style="font-size: 11.67px;">ELK</a> <a href="/tags/LLM/" style="font-size: 11.67px;">LLM</a> <a href="/tags/WLAN/" style="font-size: 10px;">WLAN</a> <a href="/tags/article/" style="font-size: 20px;">article</a> <a href="/tags/cluster/" style="font-size: 10px;">cluster</a> <a href="/tags/database/" style="font-size: 16.67px;">database</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/hexo/" style="font-size: 13.33px;">hexo</a> <a href="/tags/k8s/" style="font-size: 11.67px;">k8s</a> <a href="/tags/kvm/" style="font-size: 13.33px;">kvm</a> <a href="/tags/linux/" style="font-size: 18.33px;">linux</a> <a href="/tags/monitor/" style="font-size: 11.67px;">monitor</a> <a href="/tags/nginx/" style="font-size: 11.67px;">nginx</a> <a href="/tags/nodejs/" style="font-size: 11.67px;">nodejs</a> <a href="/tags/proxy/" style="font-size: 11.67px;">proxy</a> <a href="/tags/seo/" style="font-size: 10px;">seo</a> <a href="/tags/%E6%97%85%E6%B8%B8/" style="font-size: 10px;">旅游</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 13.33px;">网络</a> <a href="/tags/%E8%88%AA%E6%8B%8D/" style="font-size: 10px;">航拍</a>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">链接</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>

                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2024 HellShan</p>
                
                <p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="https://github.com/ppoffice" target="_blank">PPOffice</a></p>
                <p><a href="http://beian.miit.gov.cn/" target="_blank">粤ICP备2020094422号-1</a</p>
                
            </div>
            <div class="footer-plugins">
              
    


            </div>
        </div>
    </div>
</footer>

    </div>
    
    
    <script src="//unpkg.com/valine"></script>
    <script>
        var GUEST = ['nick','mail','link'];
        var meta = '';
        meta = meta.split(',').filter(function (item) {
            return GUEST.indexOf(item)>-1;
        });
        var avatarcdn = 'https://gravatar.loli.net/avatar/' == true;
        new Valine({
            el: '.vcomments',
            notify: "",
            verify: "true",
            appId: "4O7x2f71OT7FFlrdxFIAJn3v-gzGzoHsz",
            appKey: "k2d5KmEjtQeLw5IuRficyYsN",
            placeholder: "Just Do It",
            avatar:"wavatar",
            recordIP:"",
            visitor: "true"
        });
    </script>





    
        
<script src="/libs/lightgallery/js/lightgallery.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-pager.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-zoom.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-hash.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-share.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-video.min.js"></script>

    
    
        
<script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>

    
    

    
    
    



<!-- Custom Scripts -->

<script src="/js/main.js"></script>


</body>
</html>
